# ECSRPG: Классический Roguelike на Python с ECS

ECSRPG — это классическая игра в жанре roguelike, написанная на Python с использованием библиотеки Pygame. Проект служит демонстрацией применения архитектурного паттерна **Entity-Component-System (ECS)** для создания гибкой и расширяемой игровой логики. Погрузитесь в процедурно генерируемые подземелья, сражайтесь с монстрами, собирайте сокровища и развивайте своего персонажа!

## Скриншоты

*(Здесь можно разместить скриншоты игрового процесса)*

![Gameplay Screenshot](placeholder.png "Пример игрового процесса")

## Ключевые особенности

### Геймплей
- **Процедурная генерация уровней:** Каждое прохождение уникально благодаря генерации карт пещер и комнат, а также случайной расстановке врагов и предметов.
- **Классическая механика Roguelike:** Пошаговое передвижение, поле зрения (FoV) и туман войны.
- **Разнообразные враги:** Сражайтесь с гоблинами, орками, скелетами и магами. ИИ врагов включает преследование, бегство при низком здоровье, использование лечебных зелий и применение заклинаний.
- **Система предметов и экипировки:** Находите оружие, броню, зелья и магические свитки. Экипируйте лучшие предметы для усиления персонажа.
- **Боевая система:** Включает ближний бой, стрельбу из лука и магические заклинания с затратами маны и перезарядкой.
- **Прокачка персонажа:** Получайте опыт за убийство врагов, повышайте уровень и улучшайте свои характеристики (здоровье, ману, силу, защиту).
- **Сохранение состояния между уровнями:** Ваш инвентарь, здоровье и опыт сохраняются при переходе между этажами подземелья и возвращении в город-хаб.
- **Ловушки и эффекты:** Остерегайтесь скрытых ловушек, которые могут нанести урон или отравить вас.

### Технические особенности
- **Архитектура ECS:** Четкое разделение данных (`components.py`) и логики (`systems.py`), что упрощает добавление нового функционала.
- **Модульность:** Проект разбит на логические модули (ECS, компоненты, системы, фабрики сущностей, генерация карт).
- **Юнит-тесты:** Проект покрыт тестами (`tests.py`) для проверки ключевых игровых механик, таких как бой, движение, использование предметов и ИИ.

## Установка и запуск

Для запуска проекта вам понадобится Python 3.8+ и несколько библиотек.

1.  **Клонируйте репозиторий:**
    ```bash
    git clone https://github.com/ваш-логин/ECSRPG.git
    cd ECSRPG
    ```

2.  **Установите зависимости:**
    Рекомендуется использовать виртуальное окружение.
    ```bash
    python -m venv venv
    source venv/bin/activate  # Для Windows: venv\Scripts\activate
    ```
    Установите необходимые пакеты:
    ```bash
    pip install pygame numpy
    ```

3.  **Запустите игру:**
    ```bash
    python main.py
    ```

## Управление

| Клавиша         | Действие                               |
|-----------------|----------------------------------------|
| **W, A, S, D**  | Передвижение (вверх, влево, вниз, вправо) |
| **Пробел**      | Пропустить ход                          |
| **U**           | Использовать предмет из инвентаря       |
| **T**           | Бросить предмет (гранату, свиток)      |
| **E**           | Экипировать/снять предмет              |
| **G**           | Выбросить предмет из инвентаря         |
| **V**           | Использовать заклинание                |
| **F**           | Выстрелить из экипированного лука      |
| **>** (Shift+.) | Спуститься по лестнице вниз            |
| **<** (Shift+,) | Подняться по лестнице / вернуться в город |
| **C**           | Открыть экран персонажа                |
| **F1**          | Показать экран помощи                  |
| **ESC**         | Отменить прицеливание, закрыть меню    |
| **Q**           | Выйти из игры                          |
| **ЛКМ**         | Подтвердить цель для атаки/заклинания  |

**Взаимодействие:**
- **Атака:** Просто идите в сторону врага.
- **Двери:** Идите в сторону закрытой двери, чтобы открыть ее, или в сторону открытой, чтобы закрыть.
- **NPC:** Подойдите к NPC (трактирщик, торговец) для взаимодействия.

## Структура проекта

```
ECSRPG/
├── components.py         # Определения всех компонентов (чистые данные)
├── config.py             # Глобальные настройки игры (размер экрана, FPS и т.д.)
├── ecs.py                # Ядро архитектуры: классы World, System, Entity
├── entities.py           # Фабрики для создания сущностей (игрок, враги, предметы)
├── game_state.py         # Состояние игры, которое сохраняется между уровнями
├── level_themes.py       # Темы для уровней (какие монстры/предметы спавнятся)
├── main.py               # Главный файл: инициализация, игровой цикл, управление уровнями
├── map_generator.py      # Алгоритмы процедурной генерации карт
├── spawner.py            # Логика спавна сущностей на карте
├── systems.py            # Все системы, реализующие игровую логику
└── tests.py              # Юнит-тесты для проверки механик
```

## Планы на будущее

- [ ] Сохранение и загрузка игры в файл.
- [ ] Более сложный ИИ: групповое поведение, использование окружения.
- [ ] Больше контента: новые враги, боссы, предметы, заклинания, классы персонажей.
- [ ] Система квестов и диалогов.
- [ ] Звуковые эффекты и музыка.
- [ ] Улучшение пользовательского интерфейса.

## Лицензия

Этот проект распространяется под лицензией MIT. См. файл `LICENSE` для получения дополнительной информации.